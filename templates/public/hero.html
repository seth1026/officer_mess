{% block content %}

<style>
/* =========================
   HERO CAROUSEL STYLES
   ========================= */

.hero-wrapper {
    width: 100%;
    overflow: hidden;
    background-color: white;
}

.hero-carousel {
    width: 100vw;
    margin-left: calc(-50vw + 50%);
}

/* Default hero image */
.hero-img {
    width: 100%;
    height: 70vh;
    min-height: 520px;
    max-height: 800px;
    object-fit: fill; /* Default: fill screen */
}

/* Applied automatically for tall images */
.hero-img.no-crop {
    object-fit: contain;   /* NO cropping */
    background-color: white;
}

/* Caption */
.carousel-caption h5 {
    background: rgba(255, 255, 255, 0.75);
    color: #000;
    padding: 8px 16px;
    border-radius: 6px;
    display: inline-block;
}

/* Controls on white background */
.carousel-control-prev-icon,
.carousel-control-next-icon {
    filter: invert(1);
}
</style>

<!-- =========================
     HERO CAROUSEL
     ========================= -->
<div class="hero-wrapper">
    <div id="heroCarousel" class="carousel slide hero-carousel" data-bs-ride="carousel">
        <div class="carousel-inner">

            {% for slide in slides %}
            <div class="carousel-item {% if loop.index0 == 0 %}active{% endif %}">
                <img
                    src="{{ slide.url }}"
                    class="d-block w-100 hero-img auto-switch"
                    alt="Slide {{ loop.index }}"
                >

                {% if slide.caption %}
                <div class="carousel-caption d-none d-md-block">
                    <h5>{{ slide.caption }}</h5>
                </div>
                {% endif %}
            </div>
            {% endfor %}

        </div>

        <button class="carousel-control-prev" type="button"
                data-bs-target="#heroCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
            <span class="visually-hidden">Previous</span>
        </button>

        <button class="carousel-control-next" type="button"
                data-bs-target="#heroCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
</div>

<script>
/* =========================
   AUTO SWITCH LOGIC
   ========================= */

document.addEventListener("DOMContentLoaded", function () {
    const images = document.querySelectorAll(".auto-switch");

    images.forEach(img => {
        img.onload = function () {
            const ratio = img.naturalHeight / img.naturalWidth;

            // If image is tall (portrait)
            if (ratio > 1.2) {
                img.classList.add("no-crop");
            }
        };

        // Trigger for cached images
        if (img.complete) img.onload();
    });
});
</script>

{% endblock content %}
